<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
    }

    ul, li {
        list-style: none;
    }

    .axis {
        width: 100px;
        height: 300px;
        overflow-x: auto;
    }

    .box {
        width: 2000px;
        position: absolute;
    }

    .item-box {
        width: 400px;
        height: 300px;
        text-align: center;
        float: left;
        position: relative;
    }

    .content {
        padding: 0 10%;
        text-align: left;
    }

    .item-image {
        margin: 0 auto;
        width: 150px;
        height: 150px;
    }

    .item-image .alert-yellow {
        margin: 0 auto;
        width: 100px;
        height: 100px;
        background: red;
        border-radius: 50%;
        z-index: 0;
    }

    .item-box .line-left {
        z-index: -1;
        width: 50%;
        left: 0%;
        top: -80px;
        position: relative;
        height: 5px;
        background: #ccc7c9;
    }

    .item-box .line-right {
        z-index: -1;
        width: 50%;
        left: 50%;
        top: -80px;
        position: relative;
        height: 5px;
        background: #ccc7c9;
    }

    .item-box .full-line {
        z-index: -1;
        width: 100%;
        top: -80px;
        left: 0%;
        position: relative;
        height: 5px;
        background: #ccc7c9;
    }
</style>
<body>

<div class="axis">
    <div class="box">
        <div class="item-box">
            <div class="year">2017-12-07</div>
            <div class="year">14:31:24</div>

            <!--加图片-->
            <div class="item-image">
                <img src="" alt="">
                <div class="alert-yellow">
                </div>
            </div>
            <!--线-->
            <div class="line-right"></div>
            <div class="content">
                <div class="year">报警信息：助燃风机轴承故障</div>
                <div class="year">报警来源：在线预警</div>
                <div class="year">综合判断结论：综合判断结论描述</div>
                <div class="year">处理方案建议：处理方案建议描述</div>
            </div>

        </div>

        <div class="item-box">
            <div class="year">2017-12-07</div>
            <div class="year">14:31:24</div>
            <!--加图片-->
            <div class="item-image">
                <img src="" alt="">
                <div class="alert-yellow">
                </div>
            </div>
            <!--<div class="line-left"></div>-->
            <div class="full-line"></div>
            <div class="content">
                <div class="">报警信息：助燃风机轴承故障</div>
                <div class="">报警来源：在线预警</div>
                <div class="">综合判断结论：综合判断结论描述</div>
                <div class="">处理方案建议：处理方案建议描述</div>
            </div>
        </div>

        <div class="item-box">
            <div class="year">2017-12-07</div>
            <div class="year">14:31:24</div>
            <!--加图片-->
            <div class="item-image">
                <img src="" alt="">
                <div class="alert-yellow">
                </div>
            </div>
            <!--<div class="line-left"></div>-->
            <div class="full-line"></div>
            <div class="content">
                <div class="">报警信息：助燃风机轴承故障</div>
                <div class="">报警来源：在线预警</div>
                <div class="">综合判断结论：综合判断结论描述</div>
                <div class="">处理方案建议：处理方案建议描述</div>
            </div>
        </div>

        <div class="item-box">
            <div class="year">2017-12-07</div>
            <div class="year">14:31:24</div>
            <!--加图片-->
            <div class="item-image">
                <img src="" alt="">
                <div class="alert-yellow">
                </div>
            </div>
            <!--<div class="line-left"></div>-->
            <div class="full-line"></div>
            <div class="content">
                <div class="">报警信息：助燃风机轴承故障</div>
                <div class="">报警来源：在线预警</div>
                <div class="">综合判断结论：综合判断结论描述</div>
                <div class="">处理方案建议：处理方案建议描述</div>
            </div>
        </div>

        <div class="item-box">
            <div class="year">2017-12-07</div>
            <div class="year">14:31:24</div>
            <!--加图片-->
            <div class="item-image">
                <img src="" alt="">
                <div class="alert-yellow">
                </div>
            </div>
            <div class="line-left"></div>
            <div class="full-line"></div>
            <div class="content">
                <div class="">报警信息：助燃风机轴承故障</div>
                <div class="">报警来源：在线预警</div>
                <div class="">综合判断结论：综合判断结论描述</div>
                <div class="">处理方案建议：处理方案建议描述</div>
            </div>
        </div>


    </div>
</div>


</body>

<script>
  expression = {
    on: {
      init: function (event) {
        var target = event.target;
        var global = event.global;
        var myDicts = {};
        var protocol = window.location.protocol;
        var host = window.location.host;
        var lc = protocol + "//" + host;
        var reportAuthorized = {};
        var imagesList = [];
        var fileList = [];
        var ctrlGroups;
        var configParam = {
          "resourceId": "5555555"
        };
        target.setValue("reportAuthorized", reportAuthorized);

        // 请求回来的数据


        var taskId = event.target.getParameter("taskId");
        if (taskId) {
          event.target.postService("ticketTaskService", "getTicketTaskById", taskId, function (tc) {

            if (tc.code == 0) {
              ctrlGroupsObj = tc.data.variables;
              console.log(tc.data.variables);


              ctrlGroups = [[{
                type: "label",
                class: "col-md-2",
                value: "设备告警信息"
              }, {
                colSpan: 2,
                type: "input",
                value: ctrlGroupsObj.alertTitle,
                disabled: true
              }], [{
                type: "label",
                class: "col-md-2",
                value: "异常现象"
              }, {
                colSpan: 2,
                type: "select",
                value: ctrlGroupsObj.abnPhenomenon,
                on: {
                  change: function (elem) {
                    reportAuthorized.abnPhenomenon = elem.value.valueCode;
                  }
                },
                options: [],
                format: {
                  "id": "valueCode",
                  "label": "label"
                }
              }], [{
                type: "label",
                class: "col-md-2",
                composory: true,
                value: "工艺状况"
              }, {
                colSpan: 2,
                type: "select",
                value: ctrlGroupsObj.abnPhenomenon,
                on: {
                  change: function (elem) {
                    reportAuthorized.technicsStatus = elem.value.valueCode;

                  }
                },
                options: [],
                format: {
                  "id": "valueCode",
                  "label": "label"
                }
              }], [{
                type: "label",
                class: "col-md-2",
                composory: true,
                value: "检测部位"
              }, {
                colSpan: 2,
                type: "select",
                value: ctrlGroupsObj.position,
                on: {
                  change: function (elem) {
                    reportAuthorized.position = elem.value.valueCode;

                  }
                },
                options: [],
                format: {
                  "id": "valueCode",
                  "label": "label"
                }
              }], [{
                type: "label",
                class: "col-md-2",
                value: "注意事项"
              }, {
                colSpan: 2,
                type: "input",
                value: ctrlGroupsObj.attention,
                on: {
                  change: function (elem) {
                    reportAuthorized.attention = elem.value;
                    // if (event.global.detailTask.values && event.global.detailTask.values.attention != undefined) {
                    //   event.global.detailTask.values.attention = elem.value;
                    // }
                  }
                }
              }], [{
                type: "label",
                class: "col-md-2",
                value: "判断标准"
              }, {
                colSpan: 2,
                type: "select",
                value: ctrlGroupsObj.standard,
                on: {
                  change: function (elem) {
                    reportAuthorized.standard = elem.value.valueCode;
                  }
                },
                options: [],
                format: {
                  "id": "valueCode",
                  "label": "label"
                }
              }], [{
                type: "label",
                class: "col-md-2",
                value: "判断依据"
              }, {
                colSpan: 2,
                type: "select",
                value: ctrlGroupsObj.basis,
                on: {
                  change: function (elem) {
                    reportAuthorized.basis = elem.value.valueCode;
                  }
                },
                options: [],
                format: {
                  "id": "valueCode",
                  "label": "label"
                }
              }],
                [{
                  type: "label",
                  value: "判断依据图片"
                }, {
                  type: "label",
                  value: "",

                }, {
                  type: "uploadFile2",
                  icon: "glyphicon glyphicon-file",
                  group: "enterprisesImages",
                  url: "api/rest/upload/resourceFileUIService/uploadResourceFile",
                  groupId: "uploadImg1",
                  fileFormat: "png|jpg",
                  formData: configParam,
                  text: "上传图片",
                  on: {
                    submit: function (elem) {
                      var pictureObj = {
                        label: elem.label,
                        value: elem.value.qualifiedName
                      }
                      imagesList.push(pictureObj);
                      reportAuthorized.basisImage = imagesList;
                      $("#uploadImg1").parent().parent().siblings().eq(1).find("span:last")
                        .append(
                          '<div><a target="_blank" href = "' + elem.value.qualifiedName + '">' + elem.label +
                          '</a><p data-value="' + elem.label + '" style="margin-left: 20px" class="glyphicon glyphicon-remove remove-icon"></p></div>');
                      event.target.growl("上传文件成功", "success");
                      // 删除文件
                      $('.remove-icon').click(function (e) {
                        $(this).parent().remove();
                        for (var i = 0; i < reportAuthorized.basisImage.length; i++) {
                          if (reportAuthorized.basisImage[i].label == $(this).attr("data-value")) {
                            reportAuthorized.basisImage.splice(i, 1);
                            break;
                          }
                        }
                        console.log(reportAuthorized.basisImage)
                        event.target.growl("删除成功", "success");
                      })


                    }
                  }
                }],
                [{
                  type: "label",
                  class: "col-md-2",
                  value: "综合状态等级"
                }, {
                  colSpan: 2,
                  type: "select",
                  value: "请选择",
                  options: [],
                  on: {
                    change: function (elem) {
                      reportAuthorized.statusGrade = elem.value.valueCode;
                      // if (event.global.detailTask.values && event.global.detailTask.values.statusGrade != undefined) {
                      //   event.global.detailTask.values.statusGrade = elem.value.valueCode;
                      // }
                    }
                  },
                  format: {
                    "id": "valueCode",
                    "label": "label",
                  }
                }], [{
                  type: "label",
                  class: "col-md-2",
                  value: "异常部位"
                }, {
                  colSpan: 2,
                  type: "select",
                  value: ctrlGroupsObj.abnPosition,
                  on: {
                    change: function (elem) {
                      reportAuthorized.abnPosition = elem.value.valueCode;

                    }
                  },
                  options: [],
                  format: {
                    "id": "valueCode",
                    "label": "label"
                  }
                }],
                [{
                  type: "label",
                  class: "col-md-2",
                  value: "异常类型"
                }, {
                  colSpan: 2,
                  type: "select",
                  value: ctrlGroupsObj.abnType,
                  on: {
                    change: function (elem) {
                      reportAuthorized.abnType = elem.value.valueCode;

                    }
                  },
                  options: [],
                  format: {
                    "id": "valueCode",
                    "label": "label"
                  }
                }],
                [{
                  type: "label",
                  class: "col-md-2",
                  value: "故障产生原因"
                }, {
                  colSpan: 2,
                  type: "select",
                  value: ctrlGroupsObj.failureRepairReson,
                  on: {
                    change: function (elem) {
                      reportAuthorized.failureRepairReson = elem.value.valueCode;

                    }
                  },
                  options: [],
                  format: {
                    "id": "valueCode",
                    "label": "label"
                  }
                }], [{
                  type: "label",
                  class: "col-md-2",
                  value: "综合判断结论"
                }, {
                  colSpan: 2,
                  type: "select",
                  value: ctrlGroupsObj.multipleConclusion,
                  options: [],
                  on: {
                    change: function (elem) {
                      reportAuthorized.multipleConclusion = elem.value.valueCode;
                    }
                  },
                  format: {
                    "id": "valueCode",
                    "label": "label"
                  }
                }], [{
                  type: "label",
                  class: "col-md-2",
                  value: "处理方案建议"
                }, {
                  colSpan: 2,
                  type: "select",
                  value: ctrlGroupsObj.cessingScheme,
                  options: [],
                  on: {
                    change: function (elem) {
                      reportAuthorized.cessingScheme = elem.value.valueCode;
                    }
                  },
                  format: {
                    "id": "valueCode",
                    "label": "label"
                  }
                }], [
                  {
                    type: "label",
                    value: "审核人",
                    class: "col-md-2"
                  }, {
                    colSpan: 2,
                    type: "label",
                    value: ctrlGroupsObj.userName,
                  }], [{
                  type: "label",
                  value: "备注",
                  class: "col-md-2"
                }, {
                  colSpan: 2,
                  type: "textarea",
                  value: ctrlGroupsObj.remark,
                  on: {
                    change: function (elem) {
                      reportAuthorized.remark = elem.value;
                      //   if (event.global.detailTask.values && event.global.detailTask.values.remark != undefined) {
                      //     event.global.detailTask.values.remark = elem.value;
                      //   }
                    }
                  }
                }],
                [{
                  type: "label",
                  value: "上传附件"
                }, {
                  type: "label",
                  value: "",

                }, {
                  type: "uploadFile2",
                  icon: "glyphicon glyphicon-file",
                  group: "enterprisesImages",
                  url: "api/rest/upload/resourceFileUIService/uploadResourceFile",
                  groupId: "uploadImg2",
                  fileFormat: "txt|xlsx|docx|pdf|doc|png|jpg",
                  formData: configParam,
                  on: {
                    submit: function (elem) {

                      var fileObj = {
                        label: elem.label,
                        value: elem.value.qualifiedName
                      }
                      fileList.push(fileObj);
                      reportAuthorized.attUpload = fileList;
                      $("#uploadImg2").parent().parent().siblings().eq(1).find("span:last")
                        .append(
                          '<div><a target="_blank" href = "' + elem.value.qualifiedName + '">' + elem.label +
                          '</a><p data-value="' + elem.label + '" style="margin-left: 20px" class="glyphicon glyphicon-remove remove-icon"></p></div>');
                      event.target.growl("上传文件成功", "success");
                      // 删除文件
                      $('.remove-icon').click(function (e) {
                        $(this).parent().remove();
                        for (var i = 0; i < reportAuthorized.attUpload.length; i++) {
                          if (reportAuthorized.attUpload[i].label == $(this).attr("data-value")) {
                            reportAuthorized.attUpload.splice(i, 1);
                            break;
                          }
                        }
                        console.log(reportAuthorized.attUpload)
                        event.target.growl("删除成功", "success");
                      })


                    }
                  }
                }]

              ];


            }


          })
        }


        // 获取所有的字典表
        event.target.postService("dictionaryService", "getAllDicts", [], function (returnObj) {
          if (returnObj.code == 0) {
            var dic = {};
            for (var i in returnObj.data) {
              var obj = returnObj.data[i];
              if (dic[obj.dictCode]) {
                dic[obj.dictCode].push(obj);
              } else {
                dic[obj.dictCode] = [];
                dic[obj.dictCode].push(obj);
              }
            }
            for (var items in dic) {
              myDicts[items] = dic[items];
            }
            ctrlGroups[1][1].options = myDicts["abnPhenomenon"];
            ctrlGroups[2][1].options = myDicts["technicsStatus"];
            ctrlGroups[3][1].options = myDicts["position"];
            ctrlGroups[4][1].options = myDicts["attention"];
            ctrlGroups[5][1].options = myDicts["standard"];
            ctrlGroups[6][1].options = myDicts["basis"];
            ctrlGroups[8][1].options = myDicts["statusGrade"];
            ctrlGroups[9][1].options = myDicts["abnPosition"];
            ctrlGroups[10][1].options = myDicts["abnType"];
            ctrlGroups[11][1].options = myDicts["failureRepairReson"];
            ctrlGroups[12][1].options = myDicts["multipleConclusion"];
            ctrlGroups[13][1].options = myDicts["cessingScheme"];
            target.render(ctrlGroups);
          }
        })


        // 获取设备告警信息

        //   var resource = target.getPopupData();

        //   if (resource) {
        //     ctrlGroups[0][1].value = resource.ticketTitle;
        //     reportAuthorized.alertTitle = resource.ticketTitle;

        //     target.render(ctrlGroups);
        //     // 获取审核人
        //     var params = {
        //       loginName: resource.variables.AuditPerson
        //     }
        //     target.postService("userUIService", "queryUserByCondition", params, function (tc) {
        //       if (tc.data) {
        //         ctrlGroups[14][1].value = tc.data[0].userName;
        //         reportAuthorized.userName = tc.data[0].userName;
        //         // if (event.global.detailTask.values && event.global.detailTask.values.userName != undefined) {
        //         //   event.global.detailTask.values.userName = fileList;
        //         // }
        //         target.render(ctrlGroups);
        //       }
        //     })
        //   }


      }
    }
  }
</script>
</html>